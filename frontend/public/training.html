<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FIA v3.0 - Personal Training Plan</title>
    
    <!-- Prevent favicon 404 error -->
    <link rel="icon" href="data:,">
    
    <!-- Bootstrap 5.3.2 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Custom styles -->
    <link href="../src/styles/main.css" rel="stylesheet">
    
</head>
<body class="slide-viewport">
    
    <!-- Container 16:9 centrÃ© avec cadre gris -->
    <div class="slide-container-16-9">
        
        <!-- Header: Progress Bar (hauteur fixe) -->
        <div class="slide-header">
            <div id="progress-breadcrumb" class="progress-breadcrumb">
                <span class="progress-text">Training Plan</span>
            </div>
            <div class="progress-section">
                <div class="progress">
                    <div id="training-progress-bar" class="progress-bar" role="progressbar" 
                         style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                        0%
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Body: Layout 25% Chat + 75% Content (flexible) -->
        <div class="slide-body">
            
            <!-- Left Panel: Chat IA (25%) -->
            <div class="slide-chat">
                <!-- Chat Messages Area (scrollable) -->
                <div class="chat-messages" id="chat-messages">
                    <!-- Messages will be added dynamically here -->
                </div>
                
                <!-- Action Buttons -->
                <div class="chat-actions">
                    <div class="btn-group w-100" role="group" aria-label="Chat actions">
                        <button type="button" class="btn btn-outline-primary btn-sm" id="comment-btn">
                            <i class="bi bi-chat-text me-1"></i>Comment
                        </button>
                        <button type="button" class="btn btn-outline-primary btn-sm" id="quiz-btn">
                            <i class="bi bi-question-circle me-1"></i>Quiz
                        </button>
                        <button type="button" class="btn btn-outline-primary btn-sm" id="examples-btn">
                            <i class="bi bi-lightbulb me-1"></i>Examples
                        </button>
                        <button type="button" class="btn btn-outline-primary btn-sm" id="key-points-btn">
                            <i class="bi bi-star me-1"></i>Key Points
                        </button>
                    </div>
                </div>
                
                <!-- TTS Controls (above chat input) -->
                <div class="tts-controls mb-2">
                    <div class="tts-toggle-container">
                        <label class="tts-switch">
                            <input type="checkbox" id="tts-toggle">
                            <span class="tts-slider"></span>
                        </label>
                        <label for="tts-toggle" class="tts-label">Enable Audio</label>
                    </div>
                </div>
                
                <!-- Chat Input (fixed at bottom) -->
                <div class="chat-input">
                    <div class="input-group">
                        <textarea class="form-control" id="chat-input" 
                                  placeholder="Ask your AI trainer..." maxlength="500"
                                  rows="1" style="resize: none; overflow: hidden;"></textarea>
                        
                        <!-- Voice Chat Button (adaptive) -->
                        <button class="btn voice-chat-btn state-mic" type="button" id="voice-chat-btn" 
                                title="Click to start voice recording">
                            <i class="bi bi-mic" id="voice-btn-icon"></i>
                        </button>
                        
                        <!-- Fallback text for unsupported browsers -->
                        <span class="voice-not-supported">
                            <button class="btn btn-primary" type="button" id="send-message-btn-fallback">
                                <i class="bi bi-send"></i>
                            </button>
                        </span>
                    </div>
                    
                    <!-- Voice status indicator -->
                    <div class="chat-status" id="voice-status"></div>
                </div>
            </div>
            
            <!-- Right Panel: Content Area (75%) -->
            <div class="slide-content">
                
                <!-- Content Area (scrollable) -->
                <div class="content-area">
                    <div id="main-content" class="slide-content-area">
                        <!-- Content will be loaded dynamically -->
                    </div>
                </div>
                
                <!-- Navigation Bar (fixed at bottom) -->
                <div class="content-nav">
                    <button id="new-previous-btn" class="btn btn-primary" disabled>
                        <i class="bi bi-chevron-left me-1"></i>Previous
                    </button>
                    
                    <div class="interaction-buttons">
                        <button id="new-simplify-btn" class="btn btn-outline-primary me-2">
                            <i class="bi bi-arrows-collapse me-1"></i>Simplify
                        </button>
                        <button id="new-more-details-btn" class="btn btn-outline-primary me-2">
                            <i class="bi bi-arrows-expand me-1"></i>Deepen
                        </button>
                        <button id="generate-image-btn" class="btn btn-outline-primary me-2" style="display: none;">
                            <i class="bi bi-image me-1"></i>Image
                        </button>
                        <button id="generate-chart-btn" class="btn btn-outline-primary">
                            <i class="bi bi-graph-up me-1"></i>Chart
                        </button>
                    </div>
                    
                    <button id="new-next-btn" class="btn btn-primary">
                        Next<i class="bi bi-chevron-right ms-1"></i>
                    </button>
                </div>
                
            </div>
            
        </div>
        
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Marked.js for markdown parsing (KISS solution) -->
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
    
    <!-- Chart.js for chart generation -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <!-- FIA v3.0 Training Page Initialization -->
    <script type="module" src="../src/training-init.js"></script>
    
</body>
</html>